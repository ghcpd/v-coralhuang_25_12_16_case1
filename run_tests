#!/usr/bin/env python3
import os
import shutil
import subprocess
import sys

ROOT = os.path.dirname(__file__)
REQ = os.path.join(ROOT, "requirements.txt")

print("Setting up environment and running tests...")
# Install requirements
cmd = [sys.executable, "-m", "pip", "install", "-r", REQ]
ret = subprocess.call(cmd)
if ret != 0:
    print("Failed to install requirements", file=sys.stderr)
    sys.exit(ret)

# Run pytest
ret = subprocess.call([sys.executable, "-m", "pytest", "-q"]) 
sys.exit(ret)
